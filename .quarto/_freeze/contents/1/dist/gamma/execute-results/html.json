{
  "hash": "955d98a2c984c7cc0c6cd4ad76639893",
  "result": {
    "engine": "jupyter",
    "markdown": "## Gamma distribution\n\n\n\n\n::: {.hidden}\n<!-- Constants and basic symbols -->\n\n$$\n\\require{physics}\n\\require{braket}\n$$\n\n$$\n \\newcommand{\\dl}[1]{{\\hspace{#1mu}\\mathrm d}}\n \\newcommand{\\me}{{\\mathrm e}}\n$$\n\n<!-- Probability -->\n\n$$\n \\newcommand{\\Exp}{\\operatorname{E}}\n \\newcommand{\\Var}{\\operatorname{Var}}\n \\newcommand{\\Mode}{\\operatorname{mode}}\n$$\n\n<!-- Distributions pdf -->\n\n$$\n \\newcommand{\\pdfbinom}{{\\tt binom}}\n \\newcommand{\\pdfbeta}{{\\tt beta}}\n \\newcommand{\\pdfpois}{{\\tt poisson}}\n \\newcommand{\\pdfgamma}{{\\tt gamma}}\n \\newcommand{\\pdfnormal}{{\\tt norm}}\n  \\newcommand{\\pdfexp}{{\\tt expon}}\n$$\n\n<!-- Distributions -->\n\n$$\n \\newcommand{\\distbinom}{\\operatorname{B}}\n \\newcommand{\\distbeta}{\\operatorname{Beta}}\n \\newcommand{\\distgamma}{\\operatorname{Gamma}}\n \\newcommand{\\distexp}{\\operatorname{Exp}}\n \\newcommand{\\distpois}{\\operatorname{Poisson}}\n \\newcommand{\\distnormal}{\\operatorname{\\mathcal N}}\n$$\n:::\n\n\n\n\n\n::: {#def-dist-gamma}\nLet $\\mathcal Y=\\set{0,1,2,\\ldots}$. The uncertain quantity $Y\\in\\mathcal Y$ has a \\textit{Gamma distribution} (denoted by $Y\\sim\\distgamma(a,b)$ or $Y\\sim\\Gamma(a,b)$) if \n$$\n\\Pr\\qty(Y=\\theta\\mid a,b)=\\pdfgamma(\\theta,a, b)=\\dfrac{b^a}{\\Gamma(a)}\\theta^{a-1}\\me^{-b\\theta},\\quad \\text{for }\\theta,a,b>0.\n$$\n\nHere \n\n- $a$ is the **shape**.\n- $b$ is the **rate**, which also represents **effective sample size**.\n- $\\lambda=\\frac1b$ is the **scale**.\n:::\n\n\n::: {.callout-note}\n# Python code\n\n::: {#d00f6f2d .cell execution_count=1}\n``` {.python .cell-code}\nfrom scipy.stats import gamma\nimport matplotlib.pyplot as plt\nimport numpy as np\n\nrv = gamma(a=20, scale=1/2)\n\nplt.plot(rv.pdf(np.arange(100)))\n```\n\n::: {.cell-output .cell-output-display}\n![](gamma_files/figure-html/cell-2-output-1.png){width=588 height=411}\n:::\n:::\n\n\n::: {#1bfbeb51 .cell execution_count=2}\n``` {.python .cell-code}\nrv.interval(.95)\n```\n\n::: {.cell-output .cell-output-display execution_count=2}\n```\n(6.108259792701973, 14.835426785792794)\n```\n:::\n:::\n\n\n:::\n\n\n::: {#thm-dist-poisson-exp}\nIf $Y\\sim \\distgamma(a, b)$, then \n\n- $\\Exp\\qty[Y\\mid a, b]=a/b$, \n- $\\Var\\qty[Y\\mid a, b]=a/b^2$, \n- $\\Mode\\qty[Y\\mid  a, b]=$\n:::\n\n\n::: {.callout-note}\n# Proof\n\n$$\n\\begin{split}\n\\Exp\\qty[Y\\mid a,b]&= \\int_{0}^{\\infty}\\theta\\frac{b^a}{\\Gamma(a)}\\theta^{a-1}\\me^{-b\\theta}\\dl3\\theta\\\\\n&=\\int_{0}^{\\infty}\\frac{b^a}{\\Gamma(a)}\\theta^{(a+1)-1}\\me^{-b\\theta}\\dl3\\theta\\\\\n&=\\int_{0}^{\\infty}\\frac{\\Gamma(a+1)}{b\\Gamma(a)}\\frac{b^{a+1}}{\\Gamma(a+1)}\\theta^{(a+1)-1}\\me^{-b\\theta}\\dl3\\theta\\\\\n&=\\frac{\\Gamma(a+1)}{b\\Gamma(a)}\\int_{0}^{\\infty}\\pdfgamma(\\theta,a+1,b)\\dl3\\theta\\\\\n&=\\frac{a}{b},\\\\\n\\Exp\\qty[Y^2\\mid a,b]&= \\int_{0}^{\\infty}\\theta^2\\frac{b^a}{\\Gamma(a)}\\theta^{a-1}\\me^{-b\\theta}\\dl3\\theta\\\\\n&=\\int_{0}^{\\infty}\\frac{b^a}{\\Gamma(a)}\\theta^{(a+2)-1}\\me^{-b\\theta}\\dl3\\theta\\\\\n&=\\int_{0}^{\\infty}\\frac{\\Gamma(a+2)}{b^2\\Gamma(a)}\\frac{b^{a+2}}{\\Gamma(a+2)}\\theta^{(a+2)-1}\\me^{-b\\theta}\\dl3\\theta\\\\\n&=\\frac{\\Gamma(a+2)}{b^2\\Gamma(a)}\\int_{0}^{\\infty}\\pdfgamma(\\theta,a+2,b)\\dl3\\theta\\\\\n&=\\frac{a(a+1)}{b^2},\\\\\n\\Var\\qty[Y\\mid a, b]&=\\Exp\\qty[Y^2\\mid a, b]-\\qty(\\Exp\\qty[Y\\mid a, b])^2\\\\\n&=\\frac{a(a+1)}{b^2}-\\frac{a^2}{b^2}=\\frac{a}{b^2}.\n\\end{split}\n$$\n:::\n\n\n\n::: {.callout-note}\n# Vague prior\nAssume $\\epsilon>0$, then $\\distgamma(\\epsilon, \\epsilon)$ represents a distribution without knowledge. Its mean is $1$ and variance is $1/\\epsilon$ which is very large.\n\nWith Poisson likelihood, the posterior mean is $\\dfrac{\\epsilon+\\sum y_i}{\\epsilon+n}\\approx \\dfrac{\\sum y_i}{n}$ .\n:::\n\n",
    "supporting": [
      "gamma_files"
    ],
    "filters": [],
    "includes": {}
  }
}